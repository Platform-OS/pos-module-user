{% comment %}
  Gets default role permissions.
{% endcomment %}
{% liquid

  assign anonym_permissions = anonym_permissions | default: '["sessions.create", "users.register"]' | parse_json
  assign auth_permissions = '["sessions.destroy"]' | parse_json

  function permissions = 'modules/user/queries/role_permissions/permissions'
  assign _ = permissions | hash_delete_key: 'anonymous'
  assign all_permissions = permissions | hash_values | array_flatten
  assign superadmin_permissions = all_permissions | deep_clone

  assign roles = '{}' | parse_json | hash_merge: anonymous: anonym_permissions, authenticated: auth_permissions, superadmin: superadmin_permissions

  return roles
%}
